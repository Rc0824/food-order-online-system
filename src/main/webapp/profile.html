<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線上訂餐系統</title>
    <link rel="stylesheet" href="styles/stylesPro.css">
</head>

<body>
    <div id="header">
        <!-- 其他頭部內容 -->

    </div>

    <div id="profile">
        <h2>會員資料</h2>
        <div id="userInfo">
            <!-- 用戶資料將會動態顯示在這裡 -->
        </div>

        <h3>編輯會員資料</h3>
        <form id="editForm">
            <label for="name">姓名：</label>
            <input type="text" id="name" required pattern="[\u4e00-\u9fffA-Za-z]{1,30}"><br><br>

            <label for="email">電子郵件：</label>
            <input type="email" id="email" required readonly><br><br>

            <label for="phone">電話：</label>
            <input type="tel" id="phone" required pattern="09\d{8}"><br><br>

            <label for="password">密碼：</label>
            <input type="password" id="password" required pattern="(?=.*\d)(?=.*[a-zA-Z]).{8,}"><br><br>

            <input type="submit" value="保存">
            <p id="loginMessage"></p>
            <button onclick="goBack()" type="button">取消</button>
        </form>
    </div>

    <script>
        function goBack() {
            window.location.href = 'index.html'; // 返回index.html
        }

        window.onload = function () {
            const userInfo = getLoggedInUser(); // 假設此函數從 localStorage 中獲取已登入用戶信息
            displayUserInfo(userInfo); // 顯示用戶資料
        };

        function displayUserInfo(userInfo) {
            const userInfoDiv = document.getElementById('userInfo');
            userInfoDiv.innerHTML = `
                <p><strong>姓名：</strong> ${userInfo.name}</p>
                <p><strong>電子郵件：</strong> ${userInfo.email}</p>
                <p><strong>電話：</strong> ${userInfo.phone}</p>
                <p><strong>密碼：</strong> ********</p>
            `;

            // 將用戶資料填入編輯表單
            document.getElementById('name').value = userInfo.name;
            document.getElementById('email').value = userInfo.email;
            document.getElementById('phone').value = userInfo.phone;
            document.getElementById('password').value = userInfo.password;
        }

        // 提交編輯表單時的操作（保存修改後的用戶資料）
        document.getElementById('editForm').addEventListener('submit', function (event) {
            event.preventDefault(); // 防止表單提交後刷新頁面，這裡只是示例，實際操作需要與後端交互

            const updatedInfo = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                password: document.getElementById('password').value
            };
            
            // 此處應該與後端交互，更新用戶資料

            // 更新用戶資料後，重新顯示用戶資料
            displayUserInfo(updatedInfo);
            saveToLocalStorage(updatedInfo);
            alert('資料已更新！');
        });

        // 假設此函數從 localStorage 中獲取已登入用戶信息
        function getLoggedInUser() {
            return JSON.parse(localStorage.getItem('loggedInUser'));
        }

        function saveToLocalStorage(updatedInfo) {
            localStorage.setItem('loggedInUser', JSON.stringify(updatedInfo));
        }
    </script>
</body>

</html>