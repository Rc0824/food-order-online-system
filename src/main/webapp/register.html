<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>會員註冊</title>
    <link rel="stylesheet" href="styles/stylesReg.css">

</head>

<body>
    <div id="title">
        <h1>XX線上點餐系統</h1>
    </div>

    <section id="register">
        <h2>會員註冊</h2>
        <form id="registrationForm">
            <label for="name">姓名：</label>
            <input type="text" id="name" name="name" required><br><br>

            <label for="phone">電話：</label>
            <input type="tel" id="phone" name="phone" required><br><br>

            <label for="email">電子郵件：</label>
            <input type="email" id="email" name="email" required><br><br>

            <label for="password">密碼：</label>
            <input type="password" id="password" name="password" required><br><br>

            <input type="submit" value="確認註冊">
            <p id="loginMessage"></p>
            <button onclick="goBack()" type="button">取消</button> 
        </form>
    </section>

    <script>
        // "取消"按鈕功能
        function goBack() {
            window.location.href = 'index.html'; // 返回index.html
        }

        //以下為前端驗證
        const registrationForm = document.getElementById('registrationForm');

        registrationForm.addEventListener('submit', function(event) {
            event.preventDefault(); // 阻止表單默認提交行為

            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            // 驗證姓名
            const nameRegex = /^[A-Za-z\u4E00-\u9FFF\s]+$/;
            if (!nameRegex.test(name) || name.length > 30) {
                alert('姓名格式不正確（長度需小於30且僅接受中英文字符）');
                return;
            }

            // 驗證電話
            const phoneRegex = /^09[0-9]{8}$/;
            if (!phoneRegex.test(phone)) {
                alert('請輸入09開頭的10位數字電話號碼');
                return;
            }

            // 驗證電子郵件
            const emailRegex = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/;
            if (!emailRegex.test(email)) {
                alert('電子郵件格式不正確');
                return;
            }


            // 驗證密碼
            const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/;
            if (!passwordRegex.test(password)) {
                alert('密碼格式不正確（至少8個字符，至少包含一個英文字母和數字）');
                return;
            }

            // 如果通過驗證，可以進行下一步操作
            // 這裡可以添加向後端發送資料的程式碼，以及相應的後續操作
            
            register();// 假設驗證通過，彈出註冊成功提示
        });

        function register() {
            let name = document.getElementById('name').value;
            let phone = document.getElementById('phone').value;
            let email = document.getElementById('email').value;
            let password = document.getElementById('password').value;

            let data = {
                "name": name,
                "phone": phone,
                "email": email,
                "password": password
            }

            console.log(data);
            localStorage.setItem('userName', name);
            localStorage.setItem('userPhone', phone);
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userPassword', password);

            alert('註冊成功');
            window.location.href = 'index.html';
        }
    </script>
</body>

</html>